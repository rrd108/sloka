(function(t){var G={};var b={};var B=[1,729,11365,22894,22996];var p="";var J=4;var d=false;if(d){b={sloka:"",pandit:"",root:"pandit-toc-root.json",tocGet:"pandit-toc-get-response.json-",sectionGo:"pandit-section-go-response.json?",auth:"pandit-authenticate.json",expired:"pandit-expired.json",help:"help.html",logout:"pandit-auth-logout.json"}}else{b.sloka="http://pandit.hu/sloka/";b.pandit="http://pandit.hu/app/";b.root=b.pandit+"toc/root";b.tocGet=b.pandit+"toc/get/";b.sectionGo=b.pandit+"txt/section/go/";b.auth=b.pandit+"auth/authenticate";b.help="help.html";b.logout=b.pandit+"auth/logout"}function z(K){return K.search(/ének/i)!=-1||K.search(/līlā/i)!=-1||K.search(/fejezet/i)!=-1||K.search(/vers/i)!=-1||K.search(/\d+\./i)!=-1||K.search(/mantra/i)!=-1}function h(K,M,L){var N=M.partial?(' data-partial="'+M.partial+'"'):"";L=(L==M.id)?"selected ":"";K.append('<option value="'+M.id+'"'+L+N+">"+M.title+"</option>")}function I(L){var K=t("<div>"+L+"</div>");var M=K.find(".Uvaca").text()?K.find(".Uvaca").text()+"\n ":"";M+=K.find(".Vers").html().replace(/<\/*i>/g,"").replace(/<br>/g,"\n");M+="\n\n"+K.children(".Forditas").text();return M}function i(){p=p.replace(/<span class="unseen">/g,"");p=p.replace(/<\/span>/g,"")}function m(){var K,L=[];var P=/[ \-\n ]/g;while((K=P.exec(p))!=null){L.push(K.index)}var N="";var M=p.split(P);var O=0;return{splitters:L,modifiedVerse:N,words:M,pos:O}}function y(K,L){K.modifiedVerse+=L+(p[K.splitters[K.pos]]?p[K.splitters[K.pos]]:"");K.pos++}function n(){i();var K=m();t.each(K.words,function(M,O){var L=parseInt(O.length/2);var N=O.substr(0,L)+'<span class="unseen">'+O.substr(L,O.length-L)+"</span>";y(K,N)});p=K.modifiedVerse}function q(){i();var K=m();t.each(K.words,function(M,O){var L=parseInt(O.length-1);var N=O.substr(0,1)+'<span class="unseen">'+O.substr(1,L)+"</span>";y(K,N)});p=K.modifiedVerse}function x(){if(G.step==1){i()}else{if(G.step==2){n()}else{if(G.step==3){q()}}}F()}function F(){t("#main").html(p.replace(/(?:\n)/g,"<br>"))}function k(K){if(K.attr("src").search("filled")==-1){K.attr("src",K.attr("src").replace(".png","-filled.png"))}}function r(K){K.attr("src",K.attr("src").replace("-filled",""))}function g(){var M;var L="id"+t("#books").val();for(var K=2;K<5;K++){M=parseInt(t("#sel"+K).val());if(M){L+="/id"+M}}return L}function c(K){return{async:false,url:b.tocGet+K,xhrFields:{withCredentials:true},success:function(L){if(L.error=="expired"){t("#login").show();t("#app").hide()}else{if(L.id>=0){G["id"+L.id]=L;G["id"+L.id]["path"]=g()}}},error:function(L){alert("Valami gáz van típusú hibába botlottam! (buildObjForTocGet)")}}}function e(L){var K=false;if(G["id"+L]){if(G["id"+L]["children"]){K=true}}return K}function f(K){if(t.isNumeric(K)){K=[K]}t.each(K,function(L,M){select=t("#sel"+M);select.empty();select.append("<option>--- válassz ---</option>");select.hide()})}function l(){var L=t(this).val();var K=parseInt(t(this).attr("id").replace("sel",""))+1;var N=[];for(var M=K;M<J;M++){N.push(M)}f(N);if(t(this).find(":selected").data("partial")==true){if(!G["id"+L]){t.ajax(c(L))}u(K,L)}else{if(G["id"+L]){p=G["id"+L]["text"];G.lastVerse="id"+L;x();D(G.lastVerse)}else{t.ajax({url:b.sectionGo+L,success:function(O){p=I(O.text);G["id"+L]={shortRef:O.shortRef,text:p,path:g()};G.lastVerse="id"+L;x();D(G.lastVerse)},error:function(O){alert("Valami gáz van típusú hibába botlottam! (selectChangeHandler)")}})}}}function C(){if(t.localStorage("sloka.learnt")===undefined){localStorage.removeItem("sloka");t.localStorage.remove("sloka")}G=t.localStorage("sloka")?t.localStorage("sloka"):{step:1,learnt:[]};t.ajax({async:false,url:b.root,xhrFields:{withCredentials:true},success:function(K){if(K.id==0){G.loggedin=true;G.id0={id:0,children:[]};t.each(K.children,function(M,L){G.id0.children[M]={id:L.id,title:L.title,partial:L.partial?L.partial:true}});G.id1=K.children[0]}},error:function(K){alert("Valami hiba történt")}})}function w(){t("nav img.steps").click(function(K){t("nav img.steps").each(function(){if(K.target==this){G.step=t(this).attr("src").replace(".png","").replace("img/","").replace("-filled","");k(t(this))}else{r(t(this))}});x()});t("#save").click(function(){if(G.learnt.indexOf(G.lastVerse)==-1){G.learnt.push(G.lastVerse);s()}});t("#help").click(function(){t.ajax({url:b.help,success:function(K){t("#main").empty().append(K)}})});t("#logout").click(function(){t.ajax({url:b.logout,success:function(){window.location.href=b.sloka}})})}function o(){t("p").on("click","span",function(){t(this).removeClass("unseen");t(this).delay(2000).queue(function(){t(this).addClass("unseen")})})}function u(L,N,K){if(N.search("id")!==0){N="id"+N}t.each(G[N]["children"],function(O,P){if(z(P.title)){h(t("#sel"+L),P,K)}});t("#sel"+L).show();for(var M=++L;M<J;M++){f(M)}}function H(M){t("#books").empty();var K="",L="";t.each(G.id0.children,function(O,N){K+='<option value="'+N.id+'"';if(B.indexOf(N.id)==-1){K+=" disabled"}if(M=="id"+N.id){K+=" selected"}K+=">"+N.title+"</option>"});t("#books").append(K)}function E(){f([3,4]);t("#sel2").change(function(){l.call(this)});t("#sel3").change(function(){l.call(this)});t("#sel4").change(function(){l.call(this)})}function D(K){t("#shortref").text(G[K]["shortRef"])}function s(){if(G.learnt.length){var K=t("#removelearnt").hide().detach();var L=t("#footerhamburger").hide().detach();t("footer").empty().append(L.show());t.each(G.learnt,function(M,N){t("footer").append('<span data-inventoryid="'+N+'">'+G[N].shortRef+"</a>")});t("footer").append(K)}else{t("footer").append("<span>Még nincs elmentett versed</span>")}}function a(){t("footer").on("mouseover","span",function(){t(this).append(t("#removelearnt").show())});t("footer").on("mouseout","span",function(){t("#removelearnt").hide()});t("footer").click(function(N){var M;if(t(N.target).attr("id")=="removelearnt"){M=t(N.target).parent().data("inventoryid");var K=t(N.target);t(N.target).parent().remove();t("footer").append(K);G.learnt=t.grep(G.learnt,function(P){return P!=M})}else{if(t(N.target).prop("tagName")=="SPAN"){M=t(N.target).data("inventoryid");var O=v(M);x();H(O)}else{if(t(N.target).attr("id")=="footerhamburger"){var L=(t("footer").height()=="21"?"auto":"21");t("footer").height(L)}}}})}function v(M){G.lastVerse=M;p=G[M]["text"];D(M);var O=G[M].path.split("/");var N=O[0];var L=O.length-1;for(var K=0;K<L;K++){f(K+2);u(K+2,O[K],O[K+1].replace("id",""))}return N}function A(){t("#books").change(function(){f([2,3,4]);var K=t(this).find("option:selected").val();if(!e(K)){t.ajax(c(K))}u(2,K)})}function j(){E();w();o();k(t("#s"+G.step));var K="id1";if(G.lastVerse){K=v(G.lastVerse)}else{u(2,K)}x();H(K);A();s();a()}C();t(function(){if(G.loggedin===true){t("#app").show();j()}else{t("#login").show();t("#login > form").submit(function(K){K.preventDefault();t.ajax({url:b.auth,method:"POST",dataType:"json",data:{email:t("#email").val(),password:window.md5(t("#password").val())},success:function(L){if(L.ok){t("#login").hide();C();j();t("#app").show()}else{if(L.fail){alert("Hibás bejelentkezési név vagy jelszó!")}else{if(L.message){alert(L.message)}else{alert("A bejelentkezés során valamilyen mittudomén típusú hibára futottam!")}}}},error:function(L){alert("Valami gáz van típusú hibába botlottam! (onReady)")}})})}});t(window).on("unload",function(){G.loggedin=false;t.localStorage("sloka",G)})})(jQuery);!function(N){function M(f,e){var h=(65535&f)+(65535&e),g=(f>>16)+(e>>16)+(h>>16);return g<<16|65535&h}function L(d,c){return d<<c|d>>>32-c}function K(b,l,k,j,i,c){return M(L(M(M(l,b),M(j,c)),i),k)}function J(i,d,n,m,l,k,j){return K(d&n|~d&m,i,d,l,k,j)}function I(i,d,n,m,l,k,j){return K(d&m|n&~m,i,d,l,k,j)}function H(i,d,n,m,l,k,j){return K(d^n^m,i,d,l,k,j)}function G(i,d,n,m,l,k,j){return K(n^(d|~m),i,d,l,k,j)}function F(P,O){P[O>>5]|=128<<O%32,P[(O+64>>>9<<4)+14]=O;var t,s,r,q,h,g=1732584193,f=-271733879,e=-1732584194,b=271733878;for(t=0;t<P.length;t+=16){s=g,r=f,q=e,h=b,g=J(g,f,e,b,P[t],7,-680876936),b=J(b,g,f,e,P[t+1],12,-389564586),e=J(e,b,g,f,P[t+2],17,606105819),f=J(f,e,b,g,P[t+3],22,-1044525330),g=J(g,f,e,b,P[t+4],7,-176418897),b=J(b,g,f,e,P[t+5],12,1200080426),e=J(e,b,g,f,P[t+6],17,-1473231341),f=J(f,e,b,g,P[t+7],22,-45705983),g=J(g,f,e,b,P[t+8],7,1770035416),b=J(b,g,f,e,P[t+9],12,-1958414417),e=J(e,b,g,f,P[t+10],17,-42063),f=J(f,e,b,g,P[t+11],22,-1990404162),g=J(g,f,e,b,P[t+12],7,1804603682),b=J(b,g,f,e,P[t+13],12,-40341101),e=J(e,b,g,f,P[t+14],17,-1502002290),f=J(f,e,b,g,P[t+15],22,1236535329),g=I(g,f,e,b,P[t+1],5,-165796510),b=I(b,g,f,e,P[t+6],9,-1069501632),e=I(e,b,g,f,P[t+11],14,643717713),f=I(f,e,b,g,P[t],20,-373897302),g=I(g,f,e,b,P[t+5],5,-701558691),b=I(b,g,f,e,P[t+10],9,38016083),e=I(e,b,g,f,P[t+15],14,-660478335),f=I(f,e,b,g,P[t+4],20,-405537848),g=I(g,f,e,b,P[t+9],5,568446438),b=I(b,g,f,e,P[t+14],9,-1019803690),e=I(e,b,g,f,P[t+3],14,-187363961),f=I(f,e,b,g,P[t+8],20,1163531501),g=I(g,f,e,b,P[t+13],5,-1444681467),b=I(b,g,f,e,P[t+2],9,-51403784),e=I(e,b,g,f,P[t+7],14,1735328473),f=I(f,e,b,g,P[t+12],20,-1926607734),g=H(g,f,e,b,P[t+5],4,-378558),b=H(b,g,f,e,P[t+8],11,-2022574463),e=H(e,b,g,f,P[t+11],16,1839030562),f=H(f,e,b,g,P[t+14],23,-35309556),g=H(g,f,e,b,P[t+1],4,-1530992060),b=H(b,g,f,e,P[t+4],11,1272893353),e=H(e,b,g,f,P[t+7],16,-155497632),f=H(f,e,b,g,P[t+10],23,-1094730640),g=H(g,f,e,b,P[t+13],4,681279174),b=H(b,g,f,e,P[t],11,-358537222),e=H(e,b,g,f,P[t+3],16,-722521979),f=H(f,e,b,g,P[t+6],23,76029189),g=H(g,f,e,b,P[t+9],4,-640364487),b=H(b,g,f,e,P[t+12],11,-421815835),e=H(e,b,g,f,P[t+15],16,530742520),f=H(f,e,b,g,P[t+2],23,-995338651),g=G(g,f,e,b,P[t],6,-198630844),b=G(b,g,f,e,P[t+7],10,1126891415),e=G(e,b,g,f,P[t+14],15,-1416354905),f=G(f,e,b,g,P[t+5],21,-57434055),g=G(g,f,e,b,P[t+12],6,1700485571),b=G(b,g,f,e,P[t+3],10,-1894986606),e=G(e,b,g,f,P[t+10],15,-1051523),f=G(f,e,b,g,P[t+1],21,-2054922799),g=G(g,f,e,b,P[t+8],6,1873313359),b=G(b,g,f,e,P[t+15],10,-30611744),e=G(e,b,g,f,P[t+6],15,-1560198380),f=G(f,e,b,g,P[t+13],21,1309151649),g=G(g,f,e,b,P[t+4],6,-145523070),b=G(b,g,f,e,P[t+11],10,-1120210379),e=G(e,b,g,f,P[t+2],15,718787259),f=G(f,e,b,g,P[t+9],21,-343485551),g=M(g,s),f=M(f,r),e=M(e,q),b=M(b,h)}return[g,f,e,b]}function E(e){var d,f="";for(d=0;d<32*e.length;d+=8){f+=String.fromCharCode(e[d>>5]>>>d%32&255)}return f}function D(e){var d,f=[];for(f[(e.length>>2)-1]=void 0,d=0;d<f.length;d+=1){f[d]=0}for(d=0;d<8*e.length;d+=8){f[d>>5]|=(255&e.charCodeAt(d/8))<<d%32}return f}function C(b){return E(F(D(b),8*b.length))}function B(i,h){var n,m,l=D(i),k=[],j=[];for(k[15]=j[15]=void 0,l.length>16&&(l=F(l,8*i.length)),n=0;16>n;n+=1){k[n]=909522486^l[n],j[n]=1549556828^l[n]}return m=F(k.concat(D(h)),512+8*h.length),E(F(j.concat(m),640))}function A(g){var f,j,i="0123456789abcdef",h="";for(j=0;j<g.length;j+=1){f=g.charCodeAt(j),h+=i.charAt(f>>>4&15)+i.charAt(15&f)}return h}function z(b){return unescape(encodeURIComponent(b))}function y(b){return C(z(b))}function x(b){return A(y(b))}function w(d,c){return B(z(d),z(c))}function v(d,c){return A(w(d,c))}function u(e,d,f){return d?f?w(d,e):v(d,e):f?y(e):x(e)}"function"==typeof define&&define.amd?define(function(){return u}):N.md5=u}(this);